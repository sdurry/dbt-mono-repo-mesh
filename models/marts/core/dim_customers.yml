version: 2

models:
  - name: dim_customers
    description: Customer dimensions table
    config:
      access: public
      contract:
        enforced: true
    constraints:
      - type: primary_key
        name: pk_customer
        columns: [customer_key]
    columns:
      - name: customer_key
        data_type: number(38,0)
        description: Primary key on the customers table
        data_tests:
          - unique
          - not_null
      - name: region
        data_type: varchar(20)
        description: region name
        data_tests:
          - accepted_values:
              config:
                severity: warn
              arguments:
                values: ['AFRICA', 'MIDDLE EAST', 'ASIA', 'EUROPE', 'AMERICA']
      - name: name
        data_type: varchar
        description: customer id
      - name: address
        data_type: varchar
        description: address of the customer
        config:
          meta:
            masking_policy: mp_encrypt_pii
      - name: nation_key
        data_type: number(38,0)
        description: foreign key to stg_tpch_nations
      - name: nation
        data_type: varchar(15)
        description: nation name
      - name: phone_number
        data_type: varchar(15)
        description: phone number of the customer
      - name: account_balance
        data_type: number(12,2)
        description: '{{ doc("account_balance") }}'
      - name: market_segment
        data_type: varchar(10)
        description: market segment of the customer
      - name: last_updated_at
        description: system timestamp of data loading
        data_type: timestamp
