unit_tests:
  - name: test_correct_base_price # this is the unique name of the test
    description: >
      Check my base price calculation
    model: order_items # name of the model I'm unit testing
    given: # the mock data for your inputs
      - input: ref('stg_tpch_line_items')
        rows:
          - {order_key: 1 , extended_price: 10000,     quantity: 1}
          - {order_key: 2 , extended_price: 25,     quantity: null}
          - {order_key: 3 , extended_price: 12345,     quantity: 25}
          - {order_key: 4 , extended_price: 52312,     quantity: -1}
      - input: ref('stg_tpch_orders')
        rows:
          - {order_key: 1}
          - {order_key: 2}
          - {order_key: 3}
          - {order_key: 4}
    expect: # the expected output given the inputs above
      rows:
        - {extended_price: 10000,     base_price: 10000.00}
        - {extended_price: 25,     base_price: null}
        - {extended_price: 12345,     base_price: 493.80}
        - {extended_price: 52312,     base_price: -52312.00}
